<!DOCTYPE html>
<html lang="en">

<head>
  <%-include("bootstraphead")%>
  <link href="/general.css" rel="stylesheet"/>
  <title><%=media.title%></title>
</head>
<!--<script>-->
<!--  $('#exampleModal').on('show.bs.modal', function (event) {-->
<!--    var button = $(event.relatedTarget) // Button that triggered the modal-->
<!--    var recipient = button.data('whatever') // Extract info from data-* attributes-->
<!--    // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).-->
<!--    // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.-->
<!--    var modal = $(this)-->
<!--    modal.find('.modal-title').text('New message to ' + recipient)-->
<!--    modal.find('.modal-body input').val(recipient)-->
<!--  })-->
<!--</script>-->

<body style="background-color: #02131b;">
<!-- include navigation bar -->
<div>
  <%-include("nav")%>
</div>

<!-- brief details-->
<div>
  <!-- backdrop image -->
  <div id="backdropimage" style="border-bottom: 2px solid gray;">
    <div class="mt-2 pb-1" style="
            background-image: url(<%=imageURL + media.backdrop_path%>);
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            filter: brightness(30%) blur(6px);
            position: relative;
            min-height: 80vh;">

    </div>
  </div>

  <!-- brief -->
  <div id="briefdetails" style=" position: absolute; top: 18vh; bottom:10vh; left:10vw;height: max-content;">
    <div class="container">
      <div class="row ">

        <!-- poster -->
        <div class="poster col col-3">
          <div class="p-4 m-4 " style="
                  width: 267px;
                  height: 400px;
                  background-image: url(<%=imageURL + media.poster_path%>);
                  background-size: contain;
                  background-repeat: no-repeat;
                  border-radius: 2px;">
          </div>
        </div>

        <!-- details -->
        <div class="details m-2 mx-5 col-md-8">
          <div class="d-flex flex-column justify-content-start text-white ">

            <!-- media title -->
            <div class="dtitle p-2 text-capitalize font-weight-bolder mt-1">
              <h1>
                <!-- date -->
                <%=media.title%> (<%=media.release_date.slice(0, 4)%>)
              </h1>
            </div>

            <!-- media tagline -->
            <div class="ml-4" style="font-size: 1.1rem;">
              <h5>
                <footer class="blockquote-footer">
                  <cite title="Source Title"><%=media.tagline%></cite>
                </footer>
              </h5>
            </div>

            <!-- genre -->
            <div class="dgenre d-flex justify-content-start flex-wrap px-2">
              <% if(media.adult){ %>
                <!-- if adult show red pill button -->
                <a class="m-2 btn btn-danger btn-sm text-uppercase font-weight-bold" href="#"
                   role="button">
                  adult
                </a>
                <!-- media genres -->
              <% } media.genres.forEach(el=>{ %>
              <a class="m-2 btn btn-dark btn-sm text-uppercase font-weight-bold" href="#"
                 role="button">
                <%=el.name%>
              </a>
              <% }) %>
            </div>

            <!-- overview -->
            <div class="doverview text-bolder ml-4 pt-3">
              <h4>Overview</h4>
            </div>

            <!-- summary -->
            <div class="p-1 ml-4" style="max-width: 600px;">
              <p><%=media.overview%></p>
            </div>

            <div class="ml-4 mt-2">
              <h4>Featured</h4>

              <!-- Crew -->
              <h6 class="mb-0">Crew</h6>
              <div class="cast d-flex justify-content-start flex-wrap">
                <!-- filter director name from crew array -->
                <%
                creditsData.crew.filter(person => person.job === "Director").forEach(el=>{
                %>
                <div class="card-meta--container px-2 pb-2 align-self-center">
                  <!-- person avatar -->
                  <div class="card-meta--avatar rounded-circle"
                       style=" background: url(<%=imageURL + el.profile_path%>) center/cover">
                  </div>

                  <!-- person details -->
                  <div class="card-meta--title">
                    <h3 class="card-meta--name"><%=el.name%></h3>
                    <div class="card-meta--character">

                      <!-- filters all jobs of the director -->
                      <% const jobs = [] %>
                      <%=creditsData.crew.filter(person => person.name === el.name).forEach(p => jobs.push(p.job))
                      %> <%=jobs.join(" / ")%>
                    </div>
                  </div>
                </div>
                <% }) %>
              </div>

              <!-- Cast -->
              <h6 class="mb-0">Cast</h6>
              <div>
                <div class="cast d-flex justify-content-start flex-wrap">
                  <!--  first 3 persons in the casts list  -->
                  <% creditsData.cast.slice(0, 3).forEach(el=>{ %>
                  <!-- person avatar -->
                  <div class="card-meta--container px-2 pb-2 align-self-center">
                    <div class="card-meta--avatar rounded-circle"
                         style=" background: url(<%=imageURL + el.profile_path%>) center/cover">
                    </div>

                    <!-- person details -->
                    <div class="card-meta--title">
                      <h3 class="card-meta--name"><%=el.name%></h3>
                      <div class="card-meta--character">
                        <!-- person character name in media -->
                        <%=el.character%>
                      </div>
                    </div>
                  </div>
                  <% }) %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--videos details-->
<div class="videos " style="background-color: #0a0a0a; ">

  <h2 class="pb-2 pt-5 ml-5 text-white">Related Videos</h2>
  <div class="trailers  d-flex justify-content-start"
  <% if(videoinfo.length > 4){ %>
       style="overflow-x: scroll"
          <% } %>
  >
    <% videoinfo.forEach(el=>{ %>
    <div class="px-3 pb-4">
      <div class="m-0 videotumb" style="
              background-size: contain;
              background-repeat: no-repeat;
              position: relative; ">
        <img class="videoimage " src="https://img.youtube.com/vi/<%=el.key%>/0.jpg" alt="<% el.name %>"
             style="
             border-radius: 0.5rem;
              background-repeat: no-repeat;">
        <!-- Button trigger modal -->
        <button type="button" class="playy" style="border: none; outline: none;" data-toggle="modal"
                data-target="#exampleModalCenter" onclick="<% videoid = el.name %>"></button>
      </div>
      <p class="text-white-50 pl-2 "><%=el.type%>: <%=el.name%></p>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background-color: #1a202c">
          <div class="modal-header pt-2 pb-1">
            <h5 class="modal-title text-truncate text-white" id="exampleModalLongTitle">
              <%=el.type%> : <%=el.name%></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body p-0" style="height: 500px">
            <iframe src=`https://www.youtube.com/embed/FzehIddnaWU?autoplay=1` width="798"
                    height="500">
            </iframe>
          </div>
        </div>
      </div>
    </div>

    <% }) %>
  </div>

</div>

<!--<div class="bs-example">-->
<!--  &lt;!&ndash; Button HTML (to Trigger Modal) &ndash;&gt;-->
<!--  <a href="#myModal" class="btn btn-lg btn-primary" data-toggle="modal">Launch Demo Modal</a>-->

<!--  &lt;!&ndash; Modal HTML &ndash;&gt;-->
<!--  <div id="myModal" class="modal fade">-->
<!--    <div class="modal-dialog">-->
<!--      <div class="modal-content">-->
<!--        <div class="modal-header">-->
<!--          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
<!--          <h4 class="modal-title">YouTube Video</h4>-->
<!--        </div>-->
<!--        <div class="modal-body">-->
<!--          <iframe id="cartoonVideo" width="560" height="315" src="//www.youtube.com/embed/YE7VzlLtp-4"-->
<!--                  frameborder="0" allowfullscreen></iframe>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->
<!--  more details -->
<div class="moredetails m-0 p-0" style="width: 1366px;">

  <!-- crew and cast -->
  <div class="my-5 justify-content-center" style="display: grid;">
    <div class="castcrew m-3">

      <!-- tabs list-->
      <div class="list-group list-group-horizontal mb-3 justify-content-center text-center" id="list-tab"
           role="tablist">
        <!-- style="display: grid;"  max-width: 48rem; -->
        <!-- cast tab -->
        <a class="mx-2 list-group-item list-group-item-info list-group-item-action active" id="list-cast-list"
           data-toggle="list" href="#list-cast" role="tab" aria-controls="cast"
           style="border-radius: 25px; outline: none;">
          Cast
        </a>
        <!-- crew tab -->
        <a class="mx-2 list-group-item list-group-item-info list-group-item-action" id="list-crew-list"
           data-toggle="list" href="#list-crew" role="tab" aria-controls="crew"
           style="border-radius: 25px; outline: none;">
          Crew
        </a>
      </div>

      <div class="w-100"></div>

      <!-- tab content -->
      <div class="col">
        <div class="tab-content" id="nav-tabContent">

          <!-- cast -->
          <div class="tab-pane show active" id="list-cast" role="tabpanel" aria-labelledby="list-cast-list">
            <div class="cast" style="max-width: 1150px; min-width: 576px;">
              <div class="cast py-2 d-flex"
                   style="height: 285px;overflow-x: scroll;overflow-y: -moz-scrollbars-none;">

                <!-- each cast card -->
                <% creditsData.cast.forEach(el=>{ %>
                <!--  cast card background color-->
                <div class="text-white mx-2 font-weight-bold" style="
                        height: max-content;
                        width: 130px;
                        border-radius: 3px;
                        background-color: darkslategray;">

                  <!--  cast card cast image-->
                  <div style="
                          height: 195px;
                          width: inherit;
                          background: url(<%=imageURL + el.profile_path%>);
                          background-size: contain;
                          border-top-left-radius: 3px;
                          border-top-right-radius: 3px;
                          margin-bottom: -.5rem;"></div>

                  <!-- cast details -->
                  <div class=" mt-3 ">
                    <div class="m-1 pl-1 text-truncate" style="font-size: 1rem;">
                      <!-- cast name -->
                      <%=el.name%>
                    </div>
                    <div class="m-1 pl-1 text-truncate" style="font-size: 0.8rem;">
                      <!-- cast character name -->
                      <%=el.character%>
                    </div>
                  </div>
                </div>
                <% }) %>
              </div>
            </div>
          </div>

          <!-- crew -->
          <div class="tab-pane" id="list-crew" role="tabpanel" aria-labelledby="list-crew-list">
            <div class="crew" style="max-width: 1150px; min-width: 576px;">
              <div class="crew py-2 d-flex"
                   style="height: 285px; overflow-x:scroll; overflow-y:-moz-scrollbars-none;">

                <!-- each crew card -->
                <% creditsData.crew.forEach((el, currentIndex, array)=>{ %>
                  <% if((array[currentIndex + 1]) && (el.name !== array[currentIndex + 1].name)){ %>
                    <% const jobs = [] %>
                    <% creditsData.crew.forEach(value => {
                      value.name === el.name ? jobs.push(value.job) : null
                    }) %>
                    <!--  crew card crew color-->
                    <div class="text-white mx-2 font-weight-bold" style="
                        height: max-content;
                        width: 130px;
                        border-radius: 3px;
                        background-color: darkslategray;">

                      <!--  crew card background image-->
                      <div style="
                              height: 195px;
                              width: inherit;
                              background: url(<%=imageURL + el.profile_path%>);
                              background-size: cover;
                              border-top-left-radius: 3px;
                              border-top-right-radius: 3px;
                              margin-bottom: -.5rem;">
                      </div>
                      <!-- crew details -->
                      <div class=" mt-3 ">
                        <div class="m-1 pl-1 text-truncate" style="font-size: 1rem;">
                          <!-- crew name -->
                          <%=el.name%>
                        </div>
                        <div class="m-1 pl-1 text-truncate" style="font-size: 0.8rem;">
                          <!-- crew job -->
                          <%=jobs.join(" / ")%>
                        </div>
                      </div>
                    </div>
                <% }}) %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>

</html>